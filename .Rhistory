for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
variables = census_variables,
state = "CA",
county = "Los Angeles",
year = j,
output = "wide",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
la <- rbind(la,temp)
}
View(la)
la <- data_frame()
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = "Los Angeles",
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
la <- rbind(la,temp)
}
View(la)
# grab names of variables
var_names <- load_variables(2019, 'acs5', cache = TRUE)
# merge names
la <- merge(la,var_names, by.x = "variable", by.y = "name")
View(la)
# remove unneccesary variables
la_wide <- la %>% select(-1, -5, -8)
la_wide <- la_wide %>%  pivot_wider(names_from = label, values_from = estimate)
View(la_wide)
study_area <- data_frame()
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = areas,
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(study_area,temp)
}
View(study_area)
# merge names
study_area <- merge(study_area,var_names, by.x = "variable", by.y = "name")
View(study_area)
# remove unneccesary variables
study_area_wide <- study_area %>% select(-1, -5, -8)
study_area_wide <- study_area_wide %>%  pivot_wider(names_from = label, values_from = estimate)
View(study_area_wide)
get_most_recent_date <- function(day) {
dates <- seq((Sys.Date()-7),(Sys.Date()-1), by="days")
thedate <- dates[lubridate::wday(dates,label=T)==day]
return(thedate)
}
temp_tidy <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = "Los Angeles",
year = j,
output = "tidy",
geometry = FALSE)
# years for analysis
years <- c(2019, 2018, 2017, 2016, 2015)
years[1]
census_table_timeseries <- function(census_table, geography, study_areas, years) {
df <- data_frame()
for(i in years){
temp <- get_acs(geography = geography,
table = census_table,
county = areas,
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
library(tidycensus)
library(tidyverse)
census_api_key("6ed2c84b691cee46900c6dc2d03ed90d8d4db051", overwrite=TRUE)
df <- census_table_timeseries("B25014", "county", c("Los Angeles", "Orange"), c(2019,2018,2017))
census_table_timeseries <- function(census_table, geography, study_areas, years) {
df <- data_frame()
for(i in years){
temp <- get_acs(geography = geography,
table = census_table,
county = areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- census_table_timeseries("B25014", "county", c("Los Angeles", "Orange"), c(2019,2018,2017))
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
#state = "CA",
county = c("Los Angeles", "Orange"),
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(study_area,temp)
}
study_area <- data_frame()
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
#state = "CA",
county = c("Los Angeles", "Orange"),
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(study_area,temp)
}
print("Downloading data for:", j)
print(paste("Downloading data for:", j))
print(paste("Downloading data for year:", j))
# grab names of variables to join
var_names <- load_variables(2019, 'acs5', cache = TRUE)
View(study_area)
View(var_names)
View(study_area)
View(temp)
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = c("Los Angeles", "Orange"),
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(study_area,temp)
}
View(temp)
study_area <- data_frame()
study_area <- data_frame()
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = c("CA", "IL"),
county = c("Los Angeles", "Cook"),
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
study_area <- rbind(study_area,temp)
}
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", j))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- census_table_timeseries("B25014", "county", "CA" ,c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", j))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- census_table_timeseries("B25014", "county", "CA" ,c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", j))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- data_frame()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
print(names(df))
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
print(names(var_names))
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- tibble()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
print(names(df))
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
print(names(var_names))
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- tibble()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
study_area <- rbind(df,temp)
}
# print(names(df))
# # grab names of variables to join
# var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# print(names(var_names))
# # merge names
# df <- merge(df,var_names, by.x = "variable", by.y = "name")
#
# # remove unnecessary variables
# df_wide <- df %>% select(-1, -5, -8)
#
# df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
View(df)
la <- tibble()
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = "Los Angeles",
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
la <- rbind(la,temp)
}
study_area <- tibble()
# areas for analysis
areas <- c("Santa Barbara", "Ventura")
# years for analysis
years <- c(2019)
la <- tibble()
# grab data for all years
for(j in years){
print(j)
# grab data as table
temp <- get_acs(geography = "county",
table = "B25014",
state = "CA",
county = "Los Angeles",
year = j,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = j)
la <- rbind(la,temp)
}
View(la)
print(df)
print(la)
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- tibble()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
print(temp)
print(df)
study_area <- rbind(df,temp)
}
# print(names(df))
# # grab names of variables to join
# var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# print(names(var_names))
# # merge names
# df <- merge(df,var_names, by.x = "variable", by.y = "name")
#
# # remove unnecessary variables
# df_wide <- df %>% select(-1, -5, -8)
#
# df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- tibble()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
df <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
View(df)
same_state_census_table_timeseries <- function(census_table, geography, state, study_areas, years) {
df <- tibble()
for(i in years){
print(paste("Downloading data for year:", i))
temp <- get_acs(geography = geography,
table = census_table,
state = state,
county = study_areas,
year = i,
output = "tidy",
geometry = FALSE)
temp <- temp %>% mutate(year = i)
df <- rbind(df,temp)
}
# grab names of variables to join
var_names <- load_variables(years[1], 'acs5', cache = TRUE)
# merge names
df <- merge(df,var_names, by.x = "variable", by.y = "name")
# remove unnecessary variables
df_wide <- df %>% select(-1, -5, -8)
df_wide <- df_wide %>%  pivot_wider(names_from = label, values_from = estimate)
return(df_wide)
}
df <- same_state_census_table_timeseries("B25014", "county", "CA", c("Los Angeles", "Orange"), c(2019,2018,2017))
View(df)
